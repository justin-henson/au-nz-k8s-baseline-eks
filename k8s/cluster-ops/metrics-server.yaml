# Metrics Server
#
# Metrics Server collects resource metrics (CPU, memory) from Kubelets and exposes them
# via the Kubernetes Metrics API. It's required for:
# - Horizontal Pod Autoscaler (HPA)
# - Vertical Pod Autoscaler (VPA)
# - kubectl top commands
#
# On EKS, Metrics Server is often pre-installed or can be easily deployed via Helm.

---
# Installation via Helm (Recommended):
#
# 1. Add the metrics-server Helm repository:
#    helm repo add metrics-server https://kubernetes-sigs.github.io/metrics-server/
#    helm repo update
#
# 2. Install metrics-server:
#    helm install metrics-server metrics-server/metrics-server \
#      --namespace kube-system \
#      --set args[0]=--kubelet-preferred-address-types=InternalIP
#
# 3. Verify installation:
#    kubectl get deployment -n kube-system metrics-server
#    kubectl get apiservice v1beta1.metrics.k8s.io -o yaml

---
# Installation via kubectl (Alternative):
#
# 1. Download the latest release:
#    kubectl apply -f https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml
#
# 2. Verify installation:
#    kubectl get deployment metrics-server -n kube-system

---
# Verification:
#
# Check that metrics-server is running:
#   kubectl get pods -n kube-system -l k8s-app=metrics-server
#
# Test the Metrics API:
#   kubectl top nodes
#   kubectl top pods -n demo-app
#
# Check logs if there are issues:
#   kubectl logs -n kube-system -l k8s-app=metrics-server

---
# Common Issues:
#
# 1. "unable to fetch metrics": Wait 1-2 minutes after installation for metrics to be collected
#
# 2. Certificate errors: On some clusters, you may need to add --kubelet-insecure-tls flag
#    (not recommended for production)
#
# 3. Kubelet connectivity: Ensure metrics-server can reach kubelets on nodes
#    Check security groups allow traffic from metrics-server pods to kubelets (port 10250)

---
# For EKS, metrics-server typically works out of the box with these args:
#   --kubelet-preferred-address-types=InternalIP
#   --kubelet-use-node-status-port
#   --metric-resolution=15s

---
# Reference:
# - Metrics Server GitHub: https://github.com/kubernetes-sigs/metrics-server
# - EKS User Guide: https://docs.aws.amazon.com/eks/latest/userguide/metrics-server.html
